# Agent 自律行動方針

このリポジトリ内でエージェント（自動化スクリプト、Copilot など）が自律的にコードを生成・修正する際に従う必須ルールを定めます。

必須チェックリスト
- 変更前: `list_code_usages` を使って対象シンボル（関数、クラス、ツール等）の定義場所と全参照箇所を確認する。
- 変更実施: 影響範囲を最小にしつつ、必要箇所を編集する（可能なら小さなコミット単位で行う）。
- 変更後: `get_errors` を実行して静的な型/構文エラーを検出し、エラーがある限り修正を繰り返す。最終的にエラーが無いことを確認するまで終了しない。
- ドキュメント: 重要な設計判断や影響範囲はコミット/PR の説明に必ず記載する。

実務的な手順（エージェント用の擬似ワークフロー）
1. 変更対象の候補を決定する。
2. `list_code_usages` で対象シンボルの定義と参照を収集する。
3. 収集結果を解析し、影響箇所リストを作成する。
4. 影響箇所に合わせて最小限の変更を設計する。
5. 変更を適用（小さなコミット単位が望ましい）。
6. `get_errors` を実行してエラーを検出。エラーが出る場合は該当箇所を修正して 5-6 を繰り返す。
7. エラーが無くなったら、変更点を PR にまとめ、影響と検証手順を説明する。

注意点
- 外部ファイルを自動で生成する場合は、`cogent.allowExternalFileCreation` 設定やユーザー許可を尊重すること。
- 大きなリファクタや危険な変更（API 互換を壊す等）は人間レビューを必須とする。

このファイルはエージェントの「行動原則」として更新可能です。更新履歴はコミットログで管理してください。
